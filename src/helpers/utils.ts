async function processAsyncInBatch(
  inputs: Array<any>,
  f: Function,
  batchOptions: object
) {
  let batchSize: number = batchOptions.batchSize || 10;
  let numBatches = Math.ceil(inputs.length / batchSize);

  let results = [];

  for (let i = 0; i < numBatches; i++) {
    results.push(
      ...(await Promise.all(
        inputs
          .slice(i * batchSize, (i + 1) * batchSize)
          .map(async (input) => await f(input))
      ))
    );
  }
  return results;
}

export { processAsyncInBatch };
