import { readFileSync } from "fs";
import { Command, flags } from "@oclif/command";
import XSSScanner from "../helpers/xss-scanner";

export default class Hello extends Command {
  static description = "describe the command here";

  static examples = [
    `$ api-vulnerability-scanner hello
  hello world from ./src/hello.ts!
  `,
  ];

  static flags = {
    vulnerability: flags.string({
      char: "t",
      description: "Vulnerability to scan",
    }),
  };

  static args = [{ name: "url" }];

  async run() {
    const { args, flags } = this.parse(Hello);

    const url = args.url;
    if (!url) throw "Missing required field - url.";

    switch (flags?.vulnerability) {
      case "xss":
        let xssScanner = new XSSScanner();
        xssScanner.scan(url);
        console.log(xssScanner.getReport());
    }
  }
}
